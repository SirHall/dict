#!/usr/bin/env node

var https = require("https");

let word = process.argv[2];

formatList = list =>
{
    str = ""
    list.forEach(element => str += element + ", ");
    return str.substring(0, str.length - 2)
}

let req = https.request(
    {
        hostname: "googledictionaryapi.eu-gb.mybluemix.net",
        port: 443,
        path: `/?define=${word}`,
        method: "GET",
        header: 
            {
                "Content-Type": "application/json"
            }
    },
    (res) => 
    {
        res.setEncoding('utf8');
        
        res.on('data', (chunk) => 
        {
            // console.log(chunk);
            // console.log("-------");
            try 
            {
                let data = JSON.parse(chunk);
                data.forEach(def =>
                    {
                        console.log(`${def.word}:`);
                        
                        for(const [meaningType, meaning] of Object.entries(def.meaning))
                        {
                            if(meaning[0].synonyms)
                            {
                                process.stdout.write(`\t(${meaningType}):\n\t\t`);
                                console.log(formatList(meaning[0].synonyms));
                            }
                        }
                    }
                );
            }
            catch (error) 
            {
                console.log(`${word} could not be found`);
            }
        });
    }
);

req.on("error", (e) => {console.error(e.message);});
req.end();